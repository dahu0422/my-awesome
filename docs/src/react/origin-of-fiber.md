# 初识 React Fiber ：为什么需要它？

## Fiber 诞生前的痛点：同步更新的瓶颈

在 Fiber 架构出现之前，React (v16 以前) 使用一种被称为"栈协调器"（Stack Reconciler）的更新机制。这种机制存在一个核心痛点：

- **同步阻塞**：更新过程是同步递归的，一旦开始就无法中断。
- **主线程占用**：对于庞大复杂的组件树，冗长的计算任务会长时间占用浏览器主线程。
- **糟糕的体验**：主线程被阻塞时，页面无法响应用户输入（如点击、滚动），造成界面卡顿甚至白屏。

正是为了解决这个根本性问题，React Fiber 应运而生。

## Fiber 的诞生

React Fiber 的核心思想是将原本同步、一体化的渲染过程，拆解成一系列可以**异步、可中断**的微小工作单元。每个工作单元就是一个"Fiber"，它既是执行工作的单位，也是一个代表组件信息的数据结构。

React 会在浏览器的空闲时段（通过 `requestIdleCallback` 等 API）去执行这些工作单元。当更高优先级的任务（如用户输入）到来时，它可以暂停当前工作，优先处理紧急任务，待处理完毕后再回来继续之前未完成的工作。

## Fiber 核心目标

- **增量渲染 (Incremental Rendering)**: 将渲染任务切片，分布到多个时间帧中执行，避免单次任务占用主线程时间过长。
- **更新优先级 (Update Prioritization)**: 能够区分不同更新的紧急程度（如动画 > 用户输入 > 数据请求），并优先处理高优先级的更新。
- **并发支持 (Concurrency)**: 为 `useTransition` 等并发新特性提供底层架构支持，实现更流畅的用户体验。

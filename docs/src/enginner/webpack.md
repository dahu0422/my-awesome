# Webpack

Webpack 是一个静态模块打包器，用于构建 JavaScript 应用。它能统一处理各类资源文件（图片、CSS、视频等），并打包成浏览器可用的 Web 资源。

核心特点：

- 统一模块化：所有资源都视为 Module，支持代码压缩、热更新、缓存等特性
- 灵活处理：通过 Loader 和 Plugin 机制，可处理任意类型资源
- 资源互通：支持资源间信息交换，如 HTML 中嵌入 Base64 图片

作为前端工程化基座，Webpack 可集成多种工具：

- JavaScript 工具：TypeScript、Babel 等
- CSS 工具：Less、Sass、PostCSS 等
- 测试框架：Jest、Karma 等

凭借其强大的扩展性和通用性，Webpack 适用于小程序、微前端、SSR、SSG、桌面应用等多种场景，是目前最流行的构建工具之一。

## webpack 核心流程

### 1. 初始化阶段

- 初始化参数：从配置文件、配置对象、shell 参数中读取配置；
- 创建编译器对象：创建 Compiler 对象；
- 初始化编译环境：注入内置插件、注册模块工厂、初始化 RuleSet 集合等
- 开始编译：执行 `compiler.run()` 方法，创建 Compilation 对象；
- 确定入口：根据 entry 配置找出所有入口文件，转换为 dependence 对象；

### 2. 构建阶段

- 编译模块：从入口文件开始，调用 loader 转译模块内容；
- 解析 AST：将内容转换为 AST 对象，找出模块依赖；
- 递归处理：递归处理所有依赖模块；
- 完成模块编译：得到每个模块的转移内容和依赖关系图；

:::tip
AST 抽象语法树是一种以树状结构表示源代码语法结构的抽象表示。每个节点都代表源代码中的一种结构。
:::

### 3. 封装阶段

- 合并：根据依赖关系组成包含多个模块的 Chunk
- 优化：对 Chunk 进行优化，包括 `tree-shaking`、`terser`、`cCode split` 等
- 写入文件系统：确定输入路径和文件名，写入文件系统。
